{
   "Version":"2019-10-30",
   "StartAction":"ae0cc4ad-613f-4025-b9b1-e5252253e2fb",
   "Metadata":{
      "entryPointPosition":{
         "x":17.6,
         "y":20.8
      },
      "ActionMetadata":{
         "ae0cc4ad-613f-4025-b9b1-e5252253e2fb":{
            "position":{
               "x":160,
               "y":22.4
            }
         },
         "1086c38c-32cf-49bb-8302-54d33e0af07f":{
            "position":{
               "x":392,
               "y":21.6
            },
            "overrideConsoleVoice":true
         },
         "c35e5e56-60bf-4263-8253-d5aa39bb642d":{
            "position":{
               "x":616.8,
               "y":20
            }
         },
         "0546299e-4b7a-498c-a34b-8386712fec9f":{
            "position":{
               "x":90.4,
               "y":561.6
            },
            "parameters":{
               "Attributes":{
                  "prompt_id":{
                     "useDynamic":true
                  },
                  "prompt":{
                     "useDynamic":true
                  },
                  "context_switch":{
                     "useDynamic":true
                  },
                  "userPhone":{
                     "useDynamic":true
                  },
                  "guardrails_switch":{
                     "useDynamic":true
                  },
                  "brand":{
                     "useDynamic":true
                  },
                  "knowledgeBase":{
                     "useDynamic":true
                  },
                  "ragLLM":{
                     "useDynamic":true
                  },
                  "conversation":{
                     "useDynamic":true
                  }
               }
            },
            "dynamicParams":[
               "prompt_id",
               "prompt",
               "context_switch",
               "userPhone",
               "guardrails_switch",
               "brand",
               "knowledgeBase",
               "ragLLM",
               "conversation"
            ]
         },
         "4a3fd47c-6dfb-4f03-a749-a266dbe585c9":{
            "position":{
               "x":840.8,
               "y":560.8
            },
            "dynamicParams":[
               
            ]
         },
         "cc6cf75e-e789-46f2-b073-d7935df85590":{
            "position":{
               "x":1056,
               "y":420
            }
         },
         "457ca0c9-efb7-4bda-a657-092eff715444":{
            "position":{
               "x":568,
               "y":560.8
            },
            "conditions":[
               
            ],
            "conditionMetadata":[
               {
                  "id":"55fd2faf-deb0-4151-95c3-25ff890654a0",
                  "operator":{
                     "name":"Equals",
                     "value":"Equals",
                     "shortDisplay":"="
                  },
                  "value":"1"
               }
            ]
         },
         "d942f7ca-219e-47d6-a684-d7ee45a3c570":{
            "position":{
               "x":805.6,
               "y":245.6
            }
         },
         "a75be4e1-7051-49f5-b9e1-1d6cab324dd6":{
            "position":{
               "x":86.4,
               "y":288
            },
            "dynamicParams":[
               
            ]
         },
         "e24bf8fa-39f4-493c-ba6f-92e14527f5f0":{
            "position":{
               "x":332,
               "y":249.6
            },
            "parameters":{
               "LexV2Bot":{
                  "AliasArn":{
                     "displayName":"TestBotAlias",
                     "useLexBotDropdown":true,
                     "lexV2BotName":"<<bot_name>>"
                  }
               },
               "LexSessionAttributes":{
                  "prompt":{
                     "useDynamic":true
                  },
                  "prompt_id":{
                     "useDynamic":true
                  },
                  "context_switch":{
                     "useDynamic":true
                  },
                  "userPhone":{
                     "useDynamic":true
                  },
                  "guardrails_switch":{
                     "useDynamic":true
                  },
                  "brand":{
                     "useDynamic":true
                  },
                  "knowledgeBase":{
                     "useDynamic":true
                  },
                  "ragLLM":{
                     "useDynamic":true
                  },
                  "conversation":{
                     "useDynamic":true
                  }
               }
            },
            "dynamicMetadata":{
               "prompt":true,
               "prompt_id":true,
               "context_switch":true,
               "userPhone":true,
               "guardrails_switch":true,
               "brand":true,
               "knowledgeBase":true,
               "ragLLM":true,
               "conversation":true
            },
            "useLexBotDropdown":true,
            "lexV2BotName":"<<bot_name>>",
            "lexV2BotAliasName":"TestBotAlias",
            "conditionMetadata":[
               {
                  "id":"ab402a9f-a1ba-42ac-95b7-77e0ffde8e43",
                  "operator":{
                     "name":"Equals",
                     "value":"Equals",
                     "shortDisplay":"="
                  },
                  "value":"SpeakToAgent"
               },
               {
                  "id":"8b88344a-faaa-4c33-8507-3201261bc9ef",
                  "operator":{
                     "name":"Equals",
                     "value":"Equals",
                     "shortDisplay":"="
                  },
                  "value":"Goodbye"
               }
            ]
         }
      },
      "Annotations":[
         
      ],
      "name":"hotel-bot-4-sample-flow",
      "description":"Sample flow to demonstrate RAG-based Q&A via Amazon Bedrock",
      "type":"contactFlow",
      "status":"published",
      "hash":{
         
      }
   },
   "Actions":[
      {
         "Parameters":{
            "FlowLoggingBehavior":"Enabled"
         },
         "Identifier":"ae0cc4ad-613f-4025-b9b1-e5252253e2fb",
         "Type":"UpdateFlowLoggingBehavior",
         "Transitions":{
            "NextAction":"1086c38c-32cf-49bb-8302-54d33e0af07f"
         }
      },
      {
         "Parameters":{
            "TextToSpeechVoice":"Matthew",
            "TextToSpeechEngine":"Neural",
            "TextToSpeechStyle":"Conversational"
         },
         "Identifier":"1086c38c-32cf-49bb-8302-54d33e0af07f",
         "Type":"UpdateContactTextToSpeechVoice",
         "Transitions":{
            "NextAction":"c35e5e56-60bf-4263-8253-d5aa39bb642d"
         }
      },
      {
         "Parameters":{
            "Text":"Hi, welcome to Example Corp Hospitality Group."
         },
         "Identifier":"c35e5e56-60bf-4263-8253-d5aa39bb642d",
         "Type":"MessageParticipant",
         "Transitions":{
            "NextAction":"a75be4e1-7051-49f5-b9e1-1d6cab324dd6",
            "Errors":[
               {
                  "NextAction":"a75be4e1-7051-49f5-b9e1-1d6cab324dd6",
                  "ErrorType":"NoMatchingError"
               }
            ]
         }
      },
      {
         "Parameters":{
            "Attributes":{
               "prompt_id":"$.Lex.SessionAttributes.prompt_id",
               "prompt":"$.Lex.SessionAttributes.prompt",
               "context_switch":"$.Lex.SessionAttributes.context_switch",
               "userPhone":"$.Lex.SessionAttributes.userPhone",
               "guardrails_switch":"$.Lex.SessionAttributes.guardrails_switch",
               "brand":"$.Lex.SessionAttributes.brand",
               "knowledgeBase":"$.Lex.SessionAttributes.knowledgeBase",
               "ragLLM":"$.Lex.SessionAttributes.ragLLM",
               "conversation":"$.Lex.SessionAttributes.conversation"
            },
            "TargetContact":"Current"
         },
         "Identifier":"0546299e-4b7a-498c-a34b-8386712fec9f",
         "Type":"UpdateContactAttributes",
         "Transitions":{
            "NextAction":"e24bf8fa-39f4-493c-ba6f-92e14527f5f0",
            "Errors":[
               {
                  "NextAction":"e24bf8fa-39f4-493c-ba6f-92e14527f5f0",
                  "ErrorType":"NoMatchingError"
               }
            ]
         }
      },
      {
         "Parameters":{
            "Attributes":{
               "lexPrompt":"Is there anything else I can help with?"
            },
            "TargetContact":"Current"
         },
         "Identifier":"4a3fd47c-6dfb-4f03-a749-a266dbe585c9",
         "Type":"UpdateContactAttributes",
         "Transitions":{
            "NextAction":"0546299e-4b7a-498c-a34b-8386712fec9f",
            "Errors":[
               {
                  "NextAction":"0546299e-4b7a-498c-a34b-8386712fec9f",
                  "ErrorType":"NoMatchingError"
               }
            ]
         }
      },
      {
         "Parameters":{
            
         },
         "Identifier":"cc6cf75e-e789-46f2-b073-d7935df85590",
         "Type":"DisconnectParticipant",
         "Transitions":{
            
         }
      },
      {
         "Parameters":{
            "ComparisonValue":"$.Lex.SessionAttributes.sendToAgent"
         },
         "Identifier":"457ca0c9-efb7-4bda-a657-092eff715444",
         "Type":"Compare",
         "Transitions":{
            "NextAction":"4a3fd47c-6dfb-4f03-a749-a266dbe585c9",
            "Conditions":[
               {
                  "NextAction":"d942f7ca-219e-47d6-a684-d7ee45a3c570",
                  "Condition":{
                     "Operator":"Equals",
                     "Operands":[
                        "1"
                     ]
                  }
               }
            ],
            "Errors":[
               {
                  "NextAction":"4a3fd47c-6dfb-4f03-a749-a266dbe585c9",
                  "ErrorType":"NoMatchingCondition"
               }
            ]
         }
      },
      {
         "Parameters":{
            "Text":"<speak><prosody rate=\"105%\">Sorry, there are no agents available at this time.</prosody></speak>"
         },
         "Identifier":"d942f7ca-219e-47d6-a684-d7ee45a3c570",
         "Type":"MessageParticipant",
         "Transitions":{
            "NextAction":"cc6cf75e-e789-46f2-b073-d7935df85590"
         }
      },
      {
         "Parameters":{
            "Attributes":{
               "lexPrompt":"How can I help? I can answer questions about our company and our hotel brands."
            },
            "TargetContact":"Current"
         },
         "Identifier":"a75be4e1-7051-49f5-b9e1-1d6cab324dd6",
         "Type":"UpdateContactAttributes",
         "Transitions":{
            "NextAction":"e24bf8fa-39f4-493c-ba6f-92e14527f5f0",
            "Errors":[
               {
                  "NextAction":"e24bf8fa-39f4-493c-ba6f-92e14527f5f0",
                  "ErrorType":"NoMatchingError"
               }
            ]
         }
      },
      {
         "Parameters":{
            "Text":"$.Attributes.lexPrompt",
            "LexV2Bot":{
               "AliasArn":"<<bot_alias>>"
            },
            "LexSessionAttributes":{
               "prompt":"$.Attributes.prompt",
               "prompt_id":"$.Attributes.prompt_id",
               "context_switch":"$.Attributes.context_switch",
               "userPhone":"$.CustomerEndpoint.Address",
               "guardrails_switch":"$.Attributes.guardrails_switch",
               "brand":"$.Attributes.brand",
               "knowledgeBase":"$.Attributes.knowledgeBase",
               "ragLLM":"$.Lex.SessionAttributes.ragLLM",
               "conversation":"$.Lex.SessionAttributes.conversation"
            }
         },
         "Identifier":"e24bf8fa-39f4-493c-ba6f-92e14527f5f0",
         "Type":"ConnectParticipantWithLexBot",
         "Transitions":{
            "NextAction":"cc6cf75e-e789-46f2-b073-d7935df85590",
            "Conditions":[
               {
                  "NextAction":"d942f7ca-219e-47d6-a684-d7ee45a3c570",
                  "Condition":{
                     "Operator":"Equals",
                     "Operands":[
                        "SpeakToAgent"
                     ]
                  }
               },
               {
                  "NextAction":"cc6cf75e-e789-46f2-b073-d7935df85590",
                  "Condition":{
                     "Operator":"Equals",
                     "Operands":[
                        "Goodbye"
                     ]
                  }
               }
            ],
            "Errors":[
               {
                  "NextAction":"457ca0c9-efb7-4bda-a657-092eff715444",
                  "ErrorType":"NoMatchingCondition"
               },
               {
                  "NextAction":"cc6cf75e-e789-46f2-b073-d7935df85590",
                  "ErrorType":"NoMatchingError"
               }
            ]
         }
      }
   ]
}
